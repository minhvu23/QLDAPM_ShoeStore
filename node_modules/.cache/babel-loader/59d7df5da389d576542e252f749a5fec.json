{"ast":null,"code":"import _objectSpread from\"C:/Users/HP/Desktop/QLDAPM_ShoesStore/ShoesStore-ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/HP/Desktop/QLDAPM_ShoesStore/ShoesStore-ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/HP/Desktop/QLDAPM_ShoesStore/ShoesStore-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\HP\\\\Desktop\\\\QLDAPM_ShoesStore\\\\ShoesStore-ui\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useEffect,useState,useRef}from'react';import{faCircleXmark,faSpinner}from'@fortawesome/free-solid-svg-icons';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import HeadlessTippy from'@tippyjs/react/headless';import classNames from'classnames/bind';import*as searchServices from\"../../../../apiServices/searchServices\";import{Wrapper as PopperWrapper}from\"../../../Popper\";import ProductItem from\"../../../ProductItem\";import{SearchIcon}from\"../../../Icons\";import{useDebounce}from\"../../../../hooks\";import styles from\"./Search.module.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var cx=classNames.bind(styles);function Search(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchValue=_useState2[0],setSearchValue=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),searchResult=_useState4[0],setSearchResult=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),showResult=_useState6[0],setShowResult=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var debounced=useDebounce(searchValue,500);var inputRef=useRef();useEffect(function(){if(!debounced.trim()){setSearchResult([]);return;}var fetchApi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.next=3;return searchServices.search(debounced);case 3:result=_context.sent;setSearchResult(result);setLoading(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchApi(){return _ref.apply(this,arguments);};}();fetchApi();},[debounced]);var handleClear=function handleClear(){setSearchValue('');setSearchResult([]);inputRef.current.focus();};var handleHideResult=function handleHideResult(){setShowResult(false);};return/*#__PURE__*/_jsx(HeadlessTippy,{interactive:true,visible:showResult&&searchResult.length>0,render:function render(attrs){return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({className:cx('search-result'),tabIndex:\"-1\"},attrs),{},{children:/*#__PURE__*/_jsxs(PopperWrapper,{children:[/*#__PURE__*/_jsx(\"h4\",{className:cx('search-title'),children:\"Shoes\"}),searchResult.map(function(result){return/*#__PURE__*/_jsx(ProductItem,{data:result},result.id);})]})}));},onClickOutside:handleHideResult,children:/*#__PURE__*/_jsxs(\"div\",{className:cx('search'),children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,value:searchValue,placeholder:\"Search products\",spellCheck:false,onChange:function onChange(e){return setSearchValue(e.target.value);},onFocus:function onFocus(){return setShowResult(true);}}),!!searchValue&&!loading&&/*#__PURE__*/_jsx(\"button\",{className:cx('clear'),onClick:handleClear,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCircleXmark})}),loading&&/*#__PURE__*/_jsx(FontAwesomeIcon,{className:cx('loading'),icon:faSpinner}),/*#__PURE__*/_jsx(\"button\",{className:cx('search-btn'),children:/*#__PURE__*/_jsx(SearchIcon,{})})]})});}export default Search;","map":{"version":3,"sources":["C:/Users/HP/Desktop/QLDAPM_ShoesStore/ShoesStore-ui/src/components/Layout/components/Search/index.js"],"names":["useEffect","useState","useRef","faCircleXmark","faSpinner","FontAwesomeIcon","HeadlessTippy","classNames","searchServices","Wrapper","PopperWrapper","ProductItem","SearchIcon","useDebounce","styles","cx","bind","Search","searchValue","setSearchValue","searchResult","setSearchResult","showResult","setShowResult","loading","setLoading","debounced","inputRef","trim","fetchApi","search","result","handleClear","current","focus","handleHideResult","length","attrs","map","id","e","target","value"],"mappings":"gjBAAA,OAASA,SAAT,CAAoBC,QAApB,CAA8BC,MAA9B,KAA4C,OAA5C,CACA,OAASC,aAAT,CAAwBC,SAAxB,KAAyC,mCAAzC,CACA,OAASC,eAAT,KAAgC,gCAAhC,CACA,MAAOC,CAAAA,aAAP,KAA0B,yBAA1B,CACA,MAAOC,CAAAA,UAAP,KAAuB,iBAAvB,CAEA,MAAO,GAAKC,CAAAA,cAAZ,8CACA,OAASC,OAAO,GAAIC,CAAAA,aAApB,uBACA,MAAOC,CAAAA,WAAP,4BACA,OAASC,UAAT,sBACA,OAASC,WAAT,yBACA,MAAOC,CAAAA,MAAP,4B,wFAEA,GAAMC,CAAAA,EAAE,CAAGR,UAAU,CAACS,IAAX,CAAgBF,MAAhB,CAAX,CAEA,QAASG,CAAAA,MAAT,EAAkB,CACd,cAAsChB,QAAQ,CAAC,EAAD,CAA9C,wCAAOiB,WAAP,eAAoBC,cAApB,eACA,eAAwClB,QAAQ,CAAC,EAAD,CAAhD,yCAAOmB,YAAP,eAAqBC,eAArB,eACA,eAAoCpB,QAAQ,CAAC,IAAD,CAA5C,yCAAOqB,UAAP,eAAmBC,aAAnB,eACA,eAA8BtB,QAAQ,CAAC,KAAD,CAAtC,yCAAOuB,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,SAAS,CAAGb,WAAW,CAACK,WAAD,CAAc,GAAd,CAA7B,CAEA,GAAMS,CAAAA,QAAQ,CAAGzB,MAAM,EAAvB,CAEAF,SAAS,CAAC,UAAM,CACZ,GAAI,CAAC0B,SAAS,CAACE,IAAV,EAAL,CAAuB,CACnBP,eAAe,CAAC,EAAD,CAAf,CACA,OACH,CAED,GAAMQ,CAAAA,QAAQ,0FAAG,8IACbJ,UAAU,CAAC,IAAD,CAAV,CADa,sBAGQjB,CAAAA,cAAc,CAACsB,MAAf,CAAsBJ,SAAtB,CAHR,QAGPK,MAHO,eAKbV,eAAe,CAACU,MAAD,CAAf,CACAN,UAAU,CAAC,KAAD,CAAV,CANa,sDAAH,kBAARI,CAAAA,QAAQ,0CAAd,CASAA,QAAQ,GACX,CAhBQ,CAgBN,CAACH,SAAD,CAhBM,CAAT,CAkBA,GAAMM,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACtBb,cAAc,CAAC,EAAD,CAAd,CACAE,eAAe,CAAC,EAAD,CAAf,CACAM,QAAQ,CAACM,OAAT,CAAiBC,KAAjB,GACH,CAJD,CAMA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC3BZ,aAAa,CAAC,KAAD,CAAb,CACH,CAFD,CAIA,mBACI,KAAC,aAAD,EACI,WAAW,KADf,CAEI,OAAO,CAAED,UAAU,EAAIF,YAAY,CAACgB,MAAb,CAAsB,CAFjD,CAGI,MAAM,CAAE,gBAACC,KAAD,qBACJ,wCAAK,SAAS,CAAEtB,EAAE,CAAC,eAAD,CAAlB,CAAqC,QAAQ,CAAC,IAA9C,EAAuDsB,KAAvD,4BACI,MAAC,aAAD,yBACI,WAAI,SAAS,CAAEtB,EAAE,CAAC,cAAD,CAAjB,mBADJ,CAEKK,YAAY,CAACkB,GAAb,CAAiB,SAACP,MAAD,qBACd,KAAC,WAAD,EAA6B,IAAI,CAAEA,MAAnC,EAAkBA,MAAM,CAACQ,EAAzB,CADc,EAAjB,CAFL,GADJ,GADI,EAHZ,CAaI,cAAc,CAAEJ,gBAbpB,uBAeI,aAAK,SAAS,CAAEpB,EAAE,CAAC,QAAD,CAAlB,wBACI,cACI,GAAG,CAAEY,QADT,CAEI,KAAK,CAAET,WAFX,CAGI,WAAW,CAAC,iBAHhB,CAII,UAAU,CAAE,KAJhB,CAKI,QAAQ,CAAE,kBAACsB,CAAD,QAAOrB,CAAAA,cAAc,CAACqB,CAAC,CAACC,MAAF,CAASC,KAAV,CAArB,EALd,CAMI,OAAO,CAAE,yBAAMnB,CAAAA,aAAa,CAAC,IAAD,CAAnB,EANb,EADJ,CASK,CAAC,CAACL,WAAF,EAAiB,CAACM,OAAlB,eACG,eAAQ,SAAS,CAAET,EAAE,CAAC,OAAD,CAArB,CAAgC,OAAO,CAAEiB,WAAzC,uBACI,KAAC,eAAD,EAAiB,IAAI,CAAE7B,aAAvB,EADJ,EAVR,CAcKqB,OAAO,eAAI,KAAC,eAAD,EAAiB,SAAS,CAAET,EAAE,CAAC,SAAD,CAA9B,CAA2C,IAAI,CAAEX,SAAjD,EAdhB,cAgBI,eAAQ,SAAS,CAAEW,EAAE,CAAC,YAAD,CAArB,uBACI,KAAC,UAAD,IADJ,EAhBJ,GAfJ,EADJ,CAsCH,CAED,cAAeE,CAAAA,MAAf","sourcesContent":["import { useEffect, useState, useRef } from 'react';\nimport { faCircleXmark, faSpinner } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport HeadlessTippy from '@tippyjs/react/headless';\nimport classNames from 'classnames/bind';\n\nimport * as searchServices from '~/apiServices/searchServices';\nimport { Wrapper as PopperWrapper } from '~/components/Popper';\nimport ProductItem from '~/components/ProductItem';\nimport { SearchIcon } from '~/components/Icons';\nimport { useDebounce } from '~/hooks';\nimport styles from './Search.module.scss';\n\nconst cx = classNames.bind(styles);\n\nfunction Search() {\n    const [searchValue, setSearchValue] = useState('');\n    const [searchResult, setSearchResult] = useState([]);\n    const [showResult, setShowResult] = useState(true);\n    const [loading, setLoading] = useState(false);\n\n    const debounced = useDebounce(searchValue, 500);\n\n    const inputRef = useRef();\n\n    useEffect(() => {\n        if (!debounced.trim()) {\n            setSearchResult([]);\n            return;\n        }\n\n        const fetchApi = async () => {\n            setLoading(true);\n\n            const result = await searchServices.search(debounced);\n\n            setSearchResult(result);\n            setLoading(false);\n        };\n\n        fetchApi();\n    }, [debounced]);\n\n    const handleClear = () => {\n        setSearchValue('');\n        setSearchResult([]);\n        inputRef.current.focus();\n    };\n\n    const handleHideResult = () => {\n        setShowResult(false);\n    };\n\n    return (\n        <HeadlessTippy\n            interactive\n            visible={showResult && searchResult.length > 0}\n            render={(attrs) => (\n                <div className={cx('search-result')} tabIndex=\"-1\" {...attrs}>\n                    <PopperWrapper>\n                        <h4 className={cx('search-title')}>Shoes</h4>\n                        {searchResult.map((result) => (\n                            <ProductItem key={result.id} data={result} />\n                        ))}\n                    </PopperWrapper>\n                </div>\n            )}\n            onClickOutside={handleHideResult}\n        >\n            <div className={cx('search')}>\n                <input\n                    ref={inputRef}\n                    value={searchValue}\n                    placeholder=\"Search products\"\n                    spellCheck={false}\n                    onChange={(e) => setSearchValue(e.target.value)}\n                    onFocus={() => setShowResult(true)}\n                />\n                {!!searchValue && !loading && (\n                    <button className={cx('clear')} onClick={handleClear}>\n                        <FontAwesomeIcon icon={faCircleXmark} />\n                    </button>\n                )}\n                {loading && <FontAwesomeIcon className={cx('loading')} icon={faSpinner} />}\n\n                <button className={cx('search-btn')}>\n                    <SearchIcon />\n                </button>\n            </div>\n        </HeadlessTippy>\n    );\n}\n\nexport default Search;\n"]},"metadata":{},"sourceType":"module"}